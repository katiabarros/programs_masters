library (lattice)
library (openair)
library (zoo)

teste <- c(275.071, 265.926, 270.677, 271.179, 270.389, 277.502, 299.625, 293.785, 292.699, 290.527, 292.105, 283.093, 278.151, 271.877, 266.350, 260.387, 262.681, 259.030, 265.839, 281.433, 292.015, 283.653, 279.124, 272.530, 271.712, 273.443, 266.290, 267.795, 266.071, 285.284, 291.219, 298.409, 298.163, 299.626, 292.074, 284.208, 276.239, 273.780, 271.667, 275.061, 281.907, 268.131, 276.255, 282.352, 284.694, 282.825, 281.660, 278.374, 276.987, 271.751, 268.087, 260.853, 264.534, 272.481, 277.941, 292.227, 285.638, 298.672, 287.956, 278.720, 277.608, 276.948, 266.038, 265.553, 260.523, 262.279, 276.853, 293.326, 294.595, 295.143, 289.970, 275.336, 267.975, 269.113, 261.649, 259.521, 261.740, 270.458, 267.810, 277.258, 290.712, 282.828, 283.460, 269.698, 267.165, 261.281, 263.279, 257.920, 248.541, 255.921, 275.804, 274.310, 298.116, 295.948, 278.451, 274.567, 267.210, 264.062, 264.950, 265.434, 268.379, 271.115, 270.590, 273.272, 285.469, 281.062, 285.251, 272.080, 269.198, 268.219, 260.535, 259.339, 265.013, 275.697, 284.138, 280.552, 298.273, 287.572, 288.810, 280.780, 279.745, 271.678, 270.543, 273.212, 277.597, 284.098, 289.097, 298.642, 304.206, 309.034, 289.006, 281.332, 275.044, 271.520, 272.715, 261.185, 259.796, 268.897, 274.537, 280.783, 279.497, 287.363, 281.853, 273.721, 267.828, 264.215, 261.964, 263.121, 262.464, 259.506, 285.493, 287.797, 308.023, 299.472, 293.592, 276.304, 275.078, 272.104, 265.888, 266.608, 259.963, 250.792, 250.817, 268.628, 274.887, 277.822, 278.540, 274.252, 267.082, 262.635, 264.333, 256.050, 249.616, 263.700, 265.880, 275.377, 286.112, 272.900, 273.630, 260.758, 256.278, 256.413, 253.639, 245.288, 244.000, 257.117, 265.980, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 285.032, 284.234, 288.949, 292.466, 284.164, 270.947, 263.127, 264.495, 262.385, 259.331, 254.798, 248.372, 260.214, 264.176, 269.544, 272.291, 269.834, 263.389, 260.309, 253.470, 257.030, 251.368, 259.894, 266.638, 280.006, 294.769, 293.397, 293.386, 292.974, 273.709, 268.782, 267.206, 262.864, 257.373, 262.330, 257.336, 264.902, 281.436, 286.599, 294.757, 289.860, 274.465, 268.526, 266.241, 268.046, 266.112, 263.836, 270.452, 281.825, 285.169, 291.487, 294.561, 289.063, 267.214, 270.688, 266.243, 263.997, 266.027, 266.077, 265.760, 280.761, 287.308, 292.408, 298.277, 284.608, 279.349, 273.811, 269.727, 267.741, 262.844, 252.330, 245.613, 271.200, 282.689, 288.211, 287.227, 282.710, 275.388, 263.613, 270.516, 266.960, 259.360, 270.430, 272.760, 282.625, 291.161, 295.951, 297.034, 286.330, 277.259, 266.702, 267.426, 269.380, 255.798, 256.787, 256.139, 263.549, 268.470, 280.397, 274.255, 272.972, 269.661, 257.683, 260.082, 253.557, 252.681, 251.897, 253.920, 271.195, 281.326, 281.449, 288.728, 277.474, 270.513, 258.858, 251.746, 252.196, 245.924, 245.061, 252.560, 255.457, 266.167, 274.349, 266.490, 264.327, 253.056, 245.422, 251.882, 255.552, 248.157, 249.752, 260.846, 260.182, 272.603, 287.625, 280.948, 273.459, 267.802, 258.139, 254.379, 254.746, 248.723, 244.975, 244.707, 249.346, 260.785, 276.827, 270.248, 264.610, 263.285, 251.540, 250.370, 253.182, 255.226, 247.238, 266.337, 271.092, 284.767, 273.082, 278.005, 268.493, 258.638, 253.385, 247.922, 251.236, 251.273, 258.336, 258.525, 251.986, 265.077, 269.945, 275.229, 275.615, 269.243, 263.847, 264.551, 257.339, 255.760, 259.452, 262.377, 272.096, 278.675, 280.784, 280.957, 287.303, 272.981, 258.703, 261.799, 260.790, 254.450, 261.163, 263.607, 267.503, 275.945, 290.375, 278.669, 281.129, 269.091, 257.806, 258.790, 253.632, 252.221, 249.679, 240.968, 249.933, 262.056, 266.216, 267.135, 264.500, 263.480, 260.650, 261.494, 255.072, 255.081, 257.812, 260.203, 271.762, 281.317, 281.174, 287.021, 277.356, 267.086, 262.515, 261.573, 258.594, 256.193, 254.856, 244.397, 247.418, 259.230, 267.431, 270.441, 266.769, 266.009)

teste1 <- ts(teste,frequency=12, start=c(1979,1))
teste1 -> display
plot(stl(teste1,"per",na.action=na.approx))
